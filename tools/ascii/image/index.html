<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
    <link rel="stylesheet" href="../../../css/style.css">
    <link rel="apple-touch-icon" sizes="180x180" href="../../../apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../favicon-16x16.png">
    <link rel="manifest" href="../../../site.webmanifest">
    <link rel="mask-icon" href="../../../safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
    <title>Charnold Games</title>
</head>
<body>

    <div class="topnav">
        <button id="login" class="yourcommentsend" onclick="window.location.href = './login'">Log in</button>
        <button id="signup" class="yourcommentsend" onclick="window.location.href = './signup'">Sign up</button>
        <button id="profile" class="yourcommentsend" onclick="window.location.href = './profile'">Profile</button>
        <span id="usernamedisplay">Logged in as</span>
        <button id="logoutbtn" class="yourcommentsend">Log out</button>
        <h1>Charnold Games</h1>
    </div>
    <div class="topnavhidden">
        <img src="../../../assets/images/logo.png" width="256" height="256">
        <br>
        <br>
        <br>
        <br>
        <br>
        <br>
        <br>
        <br>
        <br>
        <br>
        <br>
        <br>
        <br>
        <br>
        <br>
        <a href="https://trello.com/b/DdLIO8nm/charles-game-dev-site">Check out the website's progress!</a>
    </div>

    <br>
    <br>
    <br>
    <br>

    <input type="file" id="file" accept=".jpg, .png, .jpeg">
    <button id="start" class="yourcommentsend">Upload</button>
    <br>
    Scale
    <input type="range" min="-10" max="10" value="1" class="slider" id="scaleRange">
    <span id="rangetxt">1</span>
    <canvas id="canvas" width="40" height="40" hidden></canvas>
    <img id="img" hidden>
    <div id="ascii" class="default"></div>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.9.3/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.9.3/firebase-analytics.js";
        import { getDatabase, ref, push, child, get, onValue } from "https://www.gstatic.com/firebasejs/9.9.3/firebase-database.js";
        import { isLoggedIn, getCookie, logout, firebaseConfig } from "../../../js/util.js";
        import { loadAscii } from "./index.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        // Initialize Firebase
        const app = initializeApp(firebaseConfig());
        const analytics = getAnalytics(app);

        if (isLoggedIn()) {
            document.getElementById("usernamedisplay").innerText += " " + getCookie("username");
            document.getElementById("logoutbtn").addEventListener("click", logout);
            document.getElementById("login").remove();
            document.getElementById("signup").remove();
        } else {
            document.getElementById("profile").remove();
            document.getElementById("logoutbtn").remove();
            document.getElementById("usernamedisplay").remove();
        }

        var loaded = false;
        const start = document.getElementById("start");
        const ascii = document.getElementById("ascii");
        const canvas = document.getElementById("canvas");
        const ctx = canvas.getContext("2d");
        const img = document.getElementById("img");
        const scalerange = document.getElementById("scaleRange");
        const scaletxt = document.getElementById("rangetxt");
        scalerange.addEventListener("change", function() {
            if (scalerange.value == 0) scalerange.value = 1
            scaletxt.innerText = scalerange.value;
        })
        start.addEventListener("click", function() {
            const files = document.getElementById("file").files
            if (FileReader && files && files.length) {
                const reader = new FileReader();
    
                reader.onload = function(event) {
                    img.src = reader.result;
                }
                reader.readAsDataURL(files[0])
                canvas.width = img.width
                canvas.height = img.height
                loadAscii(ascii, ctx, canvas, img)
            }
        })

      </script>

</body>
</html>